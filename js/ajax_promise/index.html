<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS 请求</title>
    <script>
        // 阻塞，优先执行JS，之后再继续解析后续的html内容
        // console.log(document.getElementById('repos'));

        // window.onload 有点晚，
        document.addEventListener('DOMContentLoaded', async () => {
            // console.log(document.getElementById('repos'));
            // then 的链式调用有点繁琐 es6 新增的语法
            // fetch('https://api.github.com/users/shunwuyu/repos')
            //     .then(res => res.json())
            //     .then(data => {
            //         // console.log(data);
            //         document.getElementById('repos').innerHTML = data.map(item => `<li>${item.name}</li>`).join('');
            //     });


            // 和同步代码一样
            // es8 新增的async await
            // await promise实例
            // new Promise Promise {} fetch的本质是返回promise实例
            // pending 状态 等待
            console.log(fetch('https://api.github.com/users/shunwuyu/repos'));
            // resolve() fullfilled 完成了
            // reject() rejected 失败了
            const result = await fetch('https://api.github.com/users/shunwuyu/repos');
            const data = await result.json();
            // console.log(data);
            document.getElementById('repos').innerHTML =
                data.map(item =>
                    `<li>${item.name}</li>`
                ).join('');
        })
    </script>
</head>

<body>
    <ul id="repos">

    </ul>
</body>

</html>